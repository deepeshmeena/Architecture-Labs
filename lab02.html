<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0067)http://bodhitree2.cse.iitb.ac.in/media/uploads/documents/lab02.html -->
<html class="gr__bodhitree2_cse_iitb_ac_in"><script type="text/javascript" charset="utf-8" id="zm-extension" src="chrome-extension://fdcgdnkidjaadafnichfpabhfomcebme/scripts/webrtc-patch.js" async=""></script><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
	
	<title></title>
	<meta name="generator" content="LibreOffice 4.2.2.1 (Windows)">
	<meta name="author" content="Bhaskaran Raman">
	<meta name="created" content="20090808;17400000">
	<meta name="changedby" content="Bhaskaran Raman">
	<meta name="changed" content="20150805;103417047000000">
	<meta name="Info 1" content="">
	<meta name="Info 2" content="">
	<meta name="Info 3" content="">
	<meta name="Info 4" content="">
	<style type="text/css">
	<!--
		p { color: #000000 }
		h1 { color: #000000 }
		h3.cjk { font-family: "SimSun" }
		h3.ctl { font-family: "Mangal" }
	-->
	</style>
</head>
<body lang="en-IN" text="#000000" dir="ltr" style="background: transparent" data-gr-c-s-loaded="true">
<h1><font color="#800000">CS341, Computer Architecture Lab, Lab 02</font></h1>
<h3 class="western"><font color="#0000ff">Goals</font></h3>
<ol>
	<li><p>Learn xspim system calls</p>
	</li><li><p>Learn global data declaration in MIPS assembly language</p>
	</li><li><p>Understand arrays in the MIPS data segment</p>
	</li><li><p>Writing a function call</p>
</li></ol>
<h3 class="western" style="page-break-after: avoid"><font color="#0000ff">Instructions</font></h3>
<ol>
	<li><p>These exercises are to be done individually.</p>
	</li><li><p>While you are encouraged to discuss with your colleagues, do
	not cross the fine line between discussion <i>to understand</i>
	versus discussion as a <i>short-cut</i> to complete your lab without
	really understanding.</p>
	</li><li><p>Create a directory called &lt;rollno&gt;-&lt;labno&gt;. Store
	all relevant files to this lab in that directory.</p>
	<ol type="a">
		<li><p>In the exercises, you will be asked various questions. Note
		down the answers to these in a file called “lab02-answers.txt”.</p>
		</li><li><p>In some parts of the exercises, you will have to show a demo
		to a TA; these are marked as such. The evaluation for each lab will
		be in the subsequent lab, or during a time-slot agreed upon with
		the TAs. For this evaluation, you need to upload your code as well.</p>
		</li><li><p>While submitting (on bodhitree), you have to create a tar.gz
		or zip of the entire &lt;rollno&gt;-&lt;labno&gt; directory in
		which all your relevant files reside.</p>
	</li></ol>
	</li><li><p>Before leaving the lab, ensure the following:</p>
	<ol type="a">
		<li><p>You have signed the attendance sheet</p>
		</li><li><p>You have uploaded your submission</p>
	</li></ol>
	</li><li><p>Things to ensure during TA evaluation of a particular lab
	submission:</p>
	<ol type="a">
		<li><p>The TA has looked at your text file with the answers to
		various questions</p>
		</li><li><p>The TA has given you marks out of 10, and has entered it in
		the marks sheet, with his/her signature</p>
		</li><li><p>You have counter-signed the above-mentioned marks</p>
	</li></ol>
	</li><li><p>You have to use the MIPS conventions, unless mentioned
	otherwise.</p>
</li></ol>
<h3 class="western" style="page-break-after: avoid"><font color="#0000ff">Learning
xspim system calls for input/output</font></h3>
<ul>
	<li><p style="margin-top: 0.17in"><font color="#000000">Look at:
	<a href="http://www.cs.uic.edu/~troy/spring04/cs366/mp1.html">http://www.cs.uic.edu/~troy/spring04/cs366/mp1.html</a></font></p>
	</li><li><p style="margin-top: 0.17in">The above webpage shows you how to
	use the “syscall” instruction to do simple input/output
	in xspim</p>
	</li><li><p style="margin-top: 0.17in"><font color="#000000">Examples are
	given in: <a href="http://www.cs.uic.edu/~troy/spring04/cs366/ex2.s">http://www.cs.uic.edu/~troy/spring04/cs366/ex2.s</a></font></p>
	</li><li><p style="margin-top: 0.17in">Copies of the above pages are also
	available on BodhiTree.</p>
	</li><li><p style="margin-top: 0.17in"><b>Demo to TA [1 mark]:</b> As an
	exercise, write a program called <b>“add.s”</b>, to
	input two integers, add them, and print the sum; show how your above
	program works, to your TA. There is no need to have any prompts for
	the input (no need to print any string).</p>
</li></ul>
<h3 class="western" style="page-break-after: avoid"><font color="#0000ff">Global
data declarations, arrays</font></h3>
<ul>
	<li><p style="margin-top: 0.17in">Search the web for “MIPS
	assembler directives”, and learn how to statically allocate
	global data using the “.data” and related assembler
	directives.</p>
	</li><li><p style="margin-top: 0.17in"><b>Demo to TA [1 mark]:</b> Now
	statically declare some prompt strings, and redo the above program
	to input two integers, calling it <b>“add-prompt.s”</b>.
	Now you must use appropriate strings to prompt the user, and to
	print the result (sum).</p>
	</li><li><p style="margin-top: 0.17in">Now consider the following C
	structure and global variable definitions:<br>typedef struct {<br>int
	re; int im;<br>} complex;<br><br>complex A[4] = { {0,0}, {-1,2},
	{0,2}, {-1,-1} };<br>int len=4;<br><br><br>
	</p>
	</li><li><p style="margin-top: 0.17in"><b>Demo to TA [1 mark]:</b> In a
	program called <b>“aDeclare.s”</b>, declare the global
	variables corresponding to the above C declarations, as static data.
	Be sure to use the “.align” assembler directive, after
	understanding what it does (use google). Now add the real and
	imaginary parts of A[2]. In this process, you would have use the
	pseudo-instruction 'la' after learning what it does.</p>
	</li><li><p style="margin-top: 0.17in"><b>Demo to TA [1 mark]:</b>
	Examine what happens without the “.align” directive.
	Create a situation where there is mis-aligned access and
	show/explain the simulator behaviour to your TA.</p>
</li></ul>
<h3 class="western" style="page-break-after: avoid"><font color="#0000ff">Using
arrays, writing functions</font></h3>
<ul>
	<li><p style="margin-top: 0.17in">Now open a new file called
	<b>“numLessThan.s”</b></p>
	</li><li><p style="margin-top: 0.17in">Write functions isLessThan and
	numLessThan, with the following C prototypes.<br>// e1 is considered
	less than e2 if e1.re&lt;e2.re or<br>// e1.re==e2.re and
	e1.im&lt;e2.im<br>// Return 1 if e1&lt;e2, 0 otherwise<br>int
	isLessThan(complex e1, complex e2);<br><br>// Given argument 'elt',
	return the number of elements of A less than<br>// 'elt'; The
	sub-array of A to considered here is [start, end)<br>int
	numLessThan(complex elt, complex* A, int start, int end);<br><br>The
	function numLessThan should call isLessThan internally. 
	Subsequently, write the main function, which will take as STDIN
	input the real and imaginary parts of a complex 'x', and call
	numLessThan(x, A, 0, len).  It should then print the return value on
	STDOUT.<br><br>The arguments of numLessThan cannot all be
	accommodated in the 4 argument registers.  This is intentional, so
	that you learn to use the stack for passing the additional argument.</p>
	<ul>
		<li><p style="margin-top: 0.17in"><i><b>Hint-1:</b></i> <i>first
		write a C-program, debug the logic, and then translate the same
		into assembly language.</i></p>
		</li><li><p style="margin-top: 0.17in"><i><b>Hint-2:</b></i> <i>you will
		be better off </i><i><u><span style="font-weight: normal">blindly</span></u></i>
		<i>translating the C-code to assembly code; else you may find
		debugging non-trivial!  </i><i>By translating </i><i><u>blindly</u></i><i>,
		I was able to do the assembly coding in about half an hour, and got
		the code working on the first run.</i></p>
		</li><li><p style="margin-top: 0.17in"><i><b>Hint-3:</b></i> When
		numLessThan calls isLessThan, you would have to carefully prepare
		the arguments; some of its own arguments are passed to isLessThan,
		but in a different order.</p>
		</li><li><p style="margin-top: 0.17in"><i><b>Warning:</b></i> <i>stepping
		through the program or continuing after a breakpoint may change any
		</i><i><u>unpreserved register</u></i> <i>(</i><i>this is an xspim
		bug</i><i>).</i></p>
	</li></ul>
	</li><li><p style="margin-top: 0.17in"><b>Demo to TA [</b><b>5</b><b>
	marks]:</b> show the working of the numLessThan routine to your TA. 
	If only the isLessThan part works, you will get 1 mark in this part.
	 If you do not follow the standard MIPS conventions of caller and
	callee saved registers, and argument/return registers, you will get
	a maximum of 2 marks in this part.</p>
	</li><li><p style="margin-top: 0.17in"><b>Question [1 mark]:</b> What
	were the aspects which were most difficult in the above assembly
	language programming? Which aspects can be improved with better
	practice, and which aspects cannot be?</p>
</li></ul>
<p style="margin-top: 0.17in"><br><br>
</p>

</body></html>